% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Predict\_Obesity\_level.R},
  pdfauthor={rohit},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Predict\_Obesity\_level.R}
\author{rohit}
\date{2025-03-09}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
## v dplyr     1.1.4     v readr     2.1.5
## v forcats   1.0.0     v stringr   1.5.1
## v ggplot2   3.5.1     v tibble    3.2.1
## v lubridate 1.9.4     v tidyr     1.3.1
## v purrr     1.0.4     
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
## i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(caret)      }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: lattice
## 
## Attaching package: 'caret'
## 
## The following object is masked from 'package:purrr':
## 
##     lift
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(randomForest) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## randomForest 4.7-1.2
## Type rfNews() to see new features/changes/bug fixes.
## 
## Attaching package: 'randomForest'
## 
## The following object is masked from 'package:dplyr':
## 
##     combine
## 
## The following object is masked from 'package:ggplot2':
## 
##     margin
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(nnet)       }
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(corrplot)  }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## corrplot 0.95 loaded
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(RColorBrewer)  }
\FunctionTok{library}\NormalTok{(ggthemes)      }
\FunctionTok{library}\NormalTok{(pheatmap)      }
\FunctionTok{library}\NormalTok{(GGally)        }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Registered S3 method overwritten by 'GGally':
##   method from   
##   +.gg   ggplot2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(pROC)          }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Type 'citation("pROC")' for a citation.
## 
## Attaching package: 'pROC'
## 
## The following objects are masked from 'package:stats':
## 
##     cov, smooth, var
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(doParallel)    }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: foreach
## 
## Attaching package: 'foreach'
## 
## The following objects are masked from 'package:purrr':
## 
##     accumulate, when
## 
## Loading required package: iterators
## Loading required package: parallel
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cl }\OtherTok{\textless{}{-}} \FunctionTok{makePSOCKcluster}\NormalTok{(}\DecValTok{4}\NormalTok{)  }
\FunctionTok{registerDoParallel}\NormalTok{(cl)}


\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"Est\_ObesityDataSet.csv"}\NormalTok{, }\AttributeTok{stringsAsFactors =} \ConstantTok{TRUE}\NormalTok{) }

\FunctionTok{str}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    1345 obs. of  17 variables:
##  $ Gender                        : Factor w/ 2 levels "Female","Male": 1 1 2 2 2 2 1 2 2 2 ...
##  $ Age                           : int  21 21 23 27 22 29 23 22 24 22 ...
##  $ Height                        : num  1.62 1.52 1.8 1.8 1.78 1.62 1.5 1.64 1.78 1.72 ...
##  $ Weight                        : int  64 56 77 87 90 53 55 53 64 68 ...
##  $ family_history_with_overweight: Factor w/ 2 levels "No","Yes": 2 2 2 1 1 1 2 1 2 2 ...
##  $ FAVC                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 2 1 2 2 ...
##  $ FCVC                          : int  2 3 2 3 2 2 3 2 3 2 ...
##  $ NCP                           : int  3 3 3 3 1 3 3 3 3 3 ...
##  $ CAEC                          : Factor w/ 4 levels "Always","Frequently",..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ SMOKE                         : Factor w/ 2 levels "No","Yes": 1 2 1 1 1 1 1 1 1 1 ...
##  $ CH2O                          : int  2 3 2 2 2 2 2 2 2 2 ...
##  $ SCC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 1 1 1 1 1 1 ...
##  $ FAF                           : int  0 3 2 2 0 0 1 3 1 1 ...
##  $ TUE                           : int  1 0 1 0 0 0 0 0 1 1 ...
##  $ CALC                          : Factor w/ 4 levels "Always","Frequently",..: 3 4 2 2 4 4 4 4 2 3 ...
##  $ MTRANS                        : Factor w/ 5 levels "Automobile","Bike",..: 4 4 4 5 4 1 3 4 4 4 ...
##  $ Obesity_Level                 : Factor w/ 7 levels "Insufficient_Weight",..: 2 2 2 6 7 2 2 2 2 2 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     Gender         Age            Height          Weight      
##  Female:688   Min.   :18.00   Min.   :1.450   Min.   : 39.00  
##  Male  :657   1st Qu.:20.00   1st Qu.:1.610   1st Qu.: 60.00  
##               Median :22.00   Median :1.680   Median : 75.00  
##               Mean   :24.33   Mean   :1.679   Mean   : 72.52  
##               3rd Qu.:26.00   3rd Qu.:1.740   3rd Qu.: 84.00  
##               Max.   :61.00   Max.   :1.930   Max.   :102.00  
##                                                               
##  family_history_with_overweight  FAVC           FCVC           NCP       
##  No :348                        No : 225   Min.   :1.00   Min.   :1.000  
##  Yes:997                        Yes:1120   1st Qu.:2.00   1st Qu.:2.000  
##                                            Median :2.00   Median :3.000  
##                                            Mean   :2.33   Mean   :2.588  
##                                            3rd Qu.:3.00   3rd Qu.:3.000  
##                                            Max.   :3.00   Max.   :4.000  
##                                                                          
##          CAEC      SMOKE           CH2O       SCC            FAF       
##  Always    :  42   No :1317   Min.   :1.00   No :1266   Min.   :0.000  
##  Frequently: 230   Yes:  28   1st Qu.:1.00   Yes:  79   1st Qu.:0.000  
##  No        :  49              Median :2.00              Median :1.000  
##  Sometimes :1024              Mean   :1.94              Mean   :1.061  
##                               3rd Qu.:2.00              3rd Qu.:2.000  
##                               Max.   :3.00              Max.   :3.000  
##                                                                        
##       TUE                 CALC                       MTRANS   
##  Min.   :0.0000   Always    :  1   Automobile           :328  
##  1st Qu.:0.0000   Frequently: 65   Bike                 :  6  
##  Median :1.0000   No        :517   Motorbike            : 10  
##  Mean   :0.6662   Sometimes :762   Public_Transportation:959  
##  3rd Qu.:1.0000                    Walking              : 42  
##  Max.   :2.0000                                               
##                                                               
##              Obesity_Level
##  Insufficient_Weight:235  
##  Normal_Weight      :262  
##  Obesity_Type_I     :248  
##  Obesity_Type_II    : 29  
##  Obesity_Type_III   : 13  
##  Overweight_Level_I :273  
##  Overweight_Level_II:285
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Gender Age Height Weight family_history_with_overweight FAVC FCVC NCP
## 1 Female  21   1.62     64                            Yes   No    2   3
## 2 Female  21   1.52     56                            Yes   No    3   3
## 3   Male  23   1.80     77                            Yes   No    2   3
## 4   Male  27   1.80     87                             No   No    3   3
## 5   Male  22   1.78     90                             No   No    2   1
## 6   Male  29   1.62     53                             No  Yes    2   3
##        CAEC SMOKE CH2O SCC FAF TUE       CALC                MTRANS
## 1 Sometimes    No    2  No   0   1         No Public_Transportation
## 2 Sometimes   Yes    3 Yes   3   0  Sometimes Public_Transportation
## 3 Sometimes    No    2  No   2   1 Frequently Public_Transportation
## 4 Sometimes    No    2  No   2   0 Frequently               Walking
## 5 Sometimes    No    2  No   0   0  Sometimes Public_Transportation
## 6 Sometimes    No    2  No   0   0  Sometimes            Automobile
##         Obesity_Level
## 1       Normal_Weight
## 2       Normal_Weight
## 3       Normal_Weight
## 4  Overweight_Level_I
## 5 Overweight_Level_II
## 6       Normal_Weight
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Total Missing Values:"}\NormalTok{, }\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(data)), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Total Missing Values: 0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.numeric), }\SpecialCharTok{\textasciitilde{}}\FunctionTok{ifelse}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(.), }\FunctionTok{median}\NormalTok{(., }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{), .)))}
         

\NormalTok{data}\SpecialCharTok{$}\NormalTok{Gender }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Gender)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Obesity\_Level }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Obesity\_Level)  }
   

\NormalTok{data }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
\FunctionTok{mutate}\NormalTok{(}\AttributeTok{BMI =}\NormalTok{ Weight }\SpecialCharTok{/}\NormalTok{ (Height}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}
     

\FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Obesity\_Level, }\AttributeTok{fill =}\NormalTok{ Obesity\_Level)) }\SpecialCharTok{+}
\FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+}
\FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Set3"}\NormalTok{) }\SpecialCharTok{+}
\FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Distribution of Obesity Levels"}\NormalTok{,}
\AttributeTok{x =} \StringTok{"Obesity Level"}\NormalTok{,}
\AttributeTok{y =} \StringTok{"Count"}\NormalTok{) }\SpecialCharTok{+}
     \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{, }
     \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Predict_Obesity_level_files/figure-latex/unnamed-chunk-1-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggpairs}\NormalTok{(data, }\AttributeTok{columns =} \FunctionTok{c}\NormalTok{(}\StringTok{"Age"}\NormalTok{, }\StringTok{"Height"}\NormalTok{, }\StringTok{"Weight"}\NormalTok{, }\StringTok{"BMI"}\NormalTok{), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ Obesity\_Level))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in cor(x, y): the standard deviation is zero
## Warning in cor(x, y): the standard deviation is zero
## Warning in cor(x, y): the standard deviation is zero
## Warning in cor(x, y): the standard deviation is zero
## Warning in cor(x, y): the standard deviation is zero
\end{verbatim}

\includegraphics{Predict_Obesity_level_files/figure-latex/unnamed-chunk-1-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numeric\_data }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%} 
\FunctionTok{select}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.numeric))}
\NormalTok{cor\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(numeric\_data, }\AttributeTok{use =} \StringTok{"complete.obs"}\NormalTok{)}
         

\FunctionTok{corrplot}\NormalTok{(cor\_matrix, }\AttributeTok{method =} \StringTok{"color"}\NormalTok{, }\AttributeTok{col =} \FunctionTok{brewer.pal}\NormalTok{(}\AttributeTok{n =} \DecValTok{9}\NormalTok{, }\AttributeTok{name =} \StringTok{"Blues"}\NormalTok{),}
         \AttributeTok{addCoef.col =} \StringTok{"black"}\NormalTok{, }\AttributeTok{tl.col =} \StringTok{"black"}\NormalTok{, }\AttributeTok{tl.srt =} \DecValTok{45}\NormalTok{, }\AttributeTok{number.cex =} \FloatTok{0.7}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Predict_Obesity_level_files/figure-latex/unnamed-chunk-1-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)  }
\NormalTok{trainIndex }\OtherTok{\textless{}{-}} \FunctionTok{createDataPartition}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Obesity\_Level, }\AttributeTok{p =} \FloatTok{0.8}\NormalTok{, }\AttributeTok{list =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{trainData }\OtherTok{\textless{}{-}}\NormalTok{ data[trainIndex, ]}
\NormalTok{testData }\OtherTok{\textless{}{-}}\NormalTok{ data[}\SpecialCharTok{{-}}\NormalTok{trainIndex, ]}
         

\NormalTok{use\_upsampling }\OtherTok{\textless{}{-}} \ConstantTok{TRUE}  \CommentTok{\# Set to FALSE to use down{-}sampling}
         
\ControlFlowTok{if}\NormalTok{ (use\_upsampling) \{}
\NormalTok{    trainData\_balanced }\OtherTok{\textless{}{-}} \FunctionTok{upSample}\NormalTok{(}\AttributeTok{x =}\NormalTok{ trainData[}\SpecialCharTok{{-}}\FunctionTok{ncol}\NormalTok{(trainData)], }\AttributeTok{y =}\NormalTok{ trainData}\SpecialCharTok{$}\NormalTok{Obesity\_Level)}
\NormalTok{    trainData\_balanced}\SpecialCharTok{$}\NormalTok{Class }\OtherTok{\textless{}{-}} \ConstantTok{NULL}  \CommentTok{\# Remove extra column added by upSample}
\NormalTok{      \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{           trainData\_balanced }\OtherTok{\textless{}{-}} \FunctionTok{downSample}\NormalTok{(}\AttributeTok{x =}\NormalTok{ trainData[}\SpecialCharTok{{-}}\FunctionTok{ncol}\NormalTok{(trainData)], }\AttributeTok{y =}\NormalTok{ trainData}\SpecialCharTok{$}\NormalTok{Obesity\_Level)}
\NormalTok{           trainData\_balanced}\SpecialCharTok{$}\NormalTok{Class }\OtherTok{\textless{}{-}} \ConstantTok{NULL}  \CommentTok{\# Remove extra column added by downSample}
\NormalTok{         \}}
         

\NormalTok{tune\_grid }\OtherTok{\textless{}{-}} \FunctionTok{expand.grid}\NormalTok{(}\AttributeTok{mtry =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{8}\NormalTok{))}
\NormalTok{rf\_model }\OtherTok{\textless{}{-}} \FunctionTok{train}\NormalTok{(Obesity\_Level }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ trainData\_balanced, }\AttributeTok{method =} \StringTok{"rf"}\NormalTok{, }
            \AttributeTok{ntree =} \DecValTok{500}\NormalTok{, }\AttributeTok{importance =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{tuneGrid =}\NormalTok{ tune\_grid,}
            \AttributeTok{trControl =} \FunctionTok{trainControl}\NormalTok{(}\AttributeTok{method =} \StringTok{"cv"}\NormalTok{, }\AttributeTok{number =} \DecValTok{5}\NormalTok{))}
         
\FunctionTok{print}\NormalTok{(rf\_model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Random Forest 
## 
## 1596 samples
##   16 predictor
##    7 classes: 'Insufficient_Weight', 'Normal_Weight', 'Obesity_Type_I', 'Obesity_Type_II', 'Obesity_Type_III', 'Overweight_Level_I', 'Overweight_Level_II' 
## 
## No pre-processing
## Resampling: Cross-Validated (5 fold) 
## Summary of sample sizes: 1276, 1278, 1277, 1275, 1278 
## Resampling results across tuning parameters:
## 
##   mtry  Accuracy   Kappa    
##   2     0.8734390  0.8523461
##   4     0.9342274  0.9232633
##   6     0.9492667  0.9408098
##   8     0.9548995  0.9473815
## 
## Accuracy was used to select the optimal model using the largest value.
## The final value used for the model was mtry = 8.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{importance\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Feature =} \FunctionTok{rownames}\NormalTok{(rf\_model}\SpecialCharTok{$}\NormalTok{finalModel}\SpecialCharTok{$}\NormalTok{importance),}
      \AttributeTok{Importance =}\NormalTok{ rf\_model}\SpecialCharTok{$}\NormalTok{finalModel}\SpecialCharTok{$}\NormalTok{importance[, }\DecValTok{1}\NormalTok{]) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(Importance))}
         
\FunctionTok{ggplot}\NormalTok{(importance\_df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{reorder}\NormalTok{(Feature, Importance), }\AttributeTok{y =}\NormalTok{ Importance, }\AttributeTok{fill =}\NormalTok{ Importance)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{coord\_flip}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_gradient}\NormalTok{(}\AttributeTok{low =} \StringTok{"lightblue"}\NormalTok{, }\AttributeTok{high =} \StringTok{"darkblue"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Feature Importance in Random Forest Model"}\NormalTok{,}
         \AttributeTok{x =} \StringTok{"Features"}\NormalTok{,}
         \AttributeTok{y =} \StringTok{"Importance"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Predict_Obesity_level_files/figure-latex/unnamed-chunk-1-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rf\_pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(rf\_model, testData)}
\NormalTok{conf\_matrix\_rf }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(rf\_pred, testData}\SpecialCharTok{$}\NormalTok{Obesity\_Level)}
\FunctionTok{print}\NormalTok{(conf\_matrix\_rf)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##                      Reference
## Prediction            Insufficient_Weight Normal_Weight Obesity_Type_I
##   Insufficient_Weight                  45             0              0
##   Normal_Weight                         2            47              0
##   Obesity_Type_I                        0             0             49
##   Obesity_Type_II                       0             0              0
##   Obesity_Type_III                      0             0              0
##   Overweight_Level_I                    0             2              0
##   Overweight_Level_II                   0             3              0
##                      Reference
## Prediction            Obesity_Type_II Obesity_Type_III Overweight_Level_I
##   Insufficient_Weight               0                0                  0
##   Normal_Weight                     0                0                  2
##   Obesity_Type_I                    0                0                  0
##   Obesity_Type_II                   5                0                  0
##   Obesity_Type_III                  0                2                  0
##   Overweight_Level_I                0                0                 48
##   Overweight_Level_II               0                0                  4
##                      Reference
## Prediction            Overweight_Level_II
##   Insufficient_Weight                   0
##   Normal_Weight                         0
##   Obesity_Type_I                        1
##   Obesity_Type_II                       0
##   Obesity_Type_III                      0
##   Overweight_Level_I                    0
##   Overweight_Level_II                  56
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9474          
##                  95% CI : (0.9133, 0.9709)
##     No Information Rate : 0.2143          
##     P-Value [Acc > NIR] : < 2.2e-16       
##                                           
##                   Kappa : 0.9349          
##                                           
##  Mcnemar's Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: Insufficient_Weight Class: Normal_Weight
## Sensitivity                              0.9574               0.9038
## Specificity                              1.0000               0.9813
## Pos Pred Value                           1.0000               0.9216
## Neg Pred Value                           0.9910               0.9767
## Prevalence                               0.1767               0.1955
## Detection Rate                           0.1692               0.1767
## Detection Prevalence                     0.1692               0.1917
## Balanced Accuracy                        0.9787               0.9426
##                      Class: Obesity_Type_I Class: Obesity_Type_II
## Sensitivity                         1.0000                 1.0000
## Specificity                         0.9954                 1.0000
## Pos Pred Value                      0.9800                 1.0000
## Neg Pred Value                      1.0000                 1.0000
## Prevalence                          0.1842                 0.0188
## Detection Rate                      0.1842                 0.0188
## Detection Prevalence                0.1880                 0.0188
## Balanced Accuracy                   0.9977                 1.0000
##                      Class: Obesity_Type_III Class: Overweight_Level_I
## Sensitivity                         1.000000                    0.8889
## Specificity                         1.000000                    0.9906
## Pos Pred Value                      1.000000                    0.9600
## Neg Pred Value                      1.000000                    0.9722
## Prevalence                          0.007519                    0.2030
## Detection Rate                      0.007519                    0.1805
## Detection Prevalence                0.007519                    0.1880
## Balanced Accuracy                   1.000000                    0.9397
##                      Class: Overweight_Level_II
## Sensitivity                              0.9825
## Specificity                              0.9665
## Pos Pred Value                           0.8889
## Neg Pred Value                           0.9951
## Prevalence                               0.2143
## Detection Rate                           0.2105
## Detection Prevalence                     0.2368
## Balanced Accuracy                        0.9745
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pheatmap}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(conf\_matrix\_rf}\SpecialCharTok{$}\NormalTok{table), }\AttributeTok{cluster\_rows =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{cluster\_cols =} \ConstantTok{FALSE}\NormalTok{,}
        \AttributeTok{display\_numbers =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{color =} \FunctionTok{colorRampPalette}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"white"}\NormalTok{, }\StringTok{"blue"}\NormalTok{))(}\DecValTok{100}\NormalTok{),}
        \AttributeTok{main =} \StringTok{"Confusion Matrix {-} Random Forest"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Predict_Obesity_level_files/figure-latex/unnamed-chunk-1-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{normalize }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
    \FunctionTok{return}\NormalTok{ ((x }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(x)) }\SpecialCharTok{/}\NormalTok{ (}\FunctionTok{max}\NormalTok{(x) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(x)))}
\NormalTok{\}}
         
\NormalTok{trainData\_norm }\OtherTok{\textless{}{-}}\NormalTok{ trainData\_balanced }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.numeric), normalize))}
\NormalTok{    testData\_norm }\OtherTok{\textless{}{-}}\NormalTok{ testData }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.numeric), normalize))}
         

\NormalTok{nn\_model }\OtherTok{\textless{}{-}} \FunctionTok{nnet}\NormalTok{(Obesity\_Level }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ trainData\_norm, }\AttributeTok{size =} \DecValTok{10}\NormalTok{, }\AttributeTok{maxit =} \DecValTok{300}\NormalTok{, }\AttributeTok{decay =} \FloatTok{0.01}\NormalTok{, }
    \AttributeTok{trace =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{MaxNWts =} \DecValTok{1000}\NormalTok{, }\AttributeTok{abstol =} \FloatTok{1.0e{-}4}\NormalTok{, }\AttributeTok{reltol =} \FloatTok{1.0e{-}8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # weights:  317
## initial  value 3364.111851 
## iter  10 value 1641.664634
## iter  20 value 715.104690
## iter  30 value 276.722370
## iter  40 value 150.280576
## iter  50 value 120.353246
## iter  60 value 105.631258
## iter  70 value 97.016177
## iter  80 value 89.629701
## iter  90 value 84.705821
## iter 100 value 81.504142
## iter 110 value 78.729452
## iter 120 value 76.398255
## iter 130 value 74.870935
## iter 140 value 73.590408
## iter 150 value 72.516302
## iter 160 value 71.682840
## iter 170 value 70.946134
## iter 180 value 70.232647
## iter 190 value 69.327789
## iter 200 value 68.518965
## iter 210 value 68.070501
## iter 220 value 67.696557
## iter 230 value 67.095724
## iter 240 value 66.520116
## iter 250 value 66.068055
## iter 260 value 65.359832
## iter 270 value 64.775755
## iter 280 value 64.536740
## iter 290 value 64.322429
## iter 300 value 64.161717
## final  value 64.161717 
## stopped after 300 iterations
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nn\_pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(nn\_model, testData\_norm, }\AttributeTok{type =} \StringTok{"raw"}\NormalTok{)}
\NormalTok{nn\_pred\_class }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(nn\_pred, }\DecValTok{1}\NormalTok{, which.max)  }
\NormalTok{levels\_list }\OtherTok{\textless{}{-}} \FunctionTok{levels}\NormalTok{(trainData\_norm}\SpecialCharTok{$}\NormalTok{Obesity\_Level)}
\NormalTok{nn\_pred\_factor }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(levels\_list[nn\_pred\_class], }\AttributeTok{levels =}\NormalTok{ levels\_list)}
         

\NormalTok{conf\_matrix\_nn }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(nn\_pred\_factor, testData\_norm}\SpecialCharTok{$}\NormalTok{Obesity\_Level)}
\FunctionTok{print}\NormalTok{(conf\_matrix\_nn)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##                      Reference
## Prediction            Insufficient_Weight Normal_Weight Obesity_Type_I
##   Insufficient_Weight                  41             0              0
##   Normal_Weight                         6            44              0
##   Obesity_Type_I                        0             0             48
##   Obesity_Type_II                       0             0              0
##   Obesity_Type_III                      0             0              0
##   Overweight_Level_I                    0             8              0
##   Overweight_Level_II                   0             0              1
##                      Reference
## Prediction            Obesity_Type_II Obesity_Type_III Overweight_Level_I
##   Insufficient_Weight               0                0                  0
##   Normal_Weight                     0                0                  2
##   Obesity_Type_I                    0                0                  0
##   Obesity_Type_II                   5                0                  0
##   Obesity_Type_III                  0                2                  0
##   Overweight_Level_I                0                0                 47
##   Overweight_Level_II               0                0                  5
##                      Reference
## Prediction            Overweight_Level_II
##   Insufficient_Weight                   0
##   Normal_Weight                         0
##   Obesity_Type_I                        1
##   Obesity_Type_II                       0
##   Obesity_Type_III                      0
##   Overweight_Level_I                    1
##   Overweight_Level_II                  55
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9098          
##                  95% CI : (0.8687, 0.9413)
##     No Information Rate : 0.2143          
##     P-Value [Acc > NIR] : < 2.2e-16       
##                                           
##                   Kappa : 0.8884          
##                                           
##  Mcnemar's Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: Insufficient_Weight Class: Normal_Weight
## Sensitivity                              0.8723               0.8462
## Specificity                              1.0000               0.9626
## Pos Pred Value                           1.0000               0.8462
## Neg Pred Value                           0.9733               0.9626
## Prevalence                               0.1767               0.1955
## Detection Rate                           0.1541               0.1654
## Detection Prevalence                     0.1541               0.1955
## Balanced Accuracy                        0.9362               0.9044
##                      Class: Obesity_Type_I Class: Obesity_Type_II
## Sensitivity                         0.9796                 1.0000
## Specificity                         0.9954                 1.0000
## Pos Pred Value                      0.9796                 1.0000
## Neg Pred Value                      0.9954                 1.0000
## Prevalence                          0.1842                 0.0188
## Detection Rate                      0.1805                 0.0188
## Detection Prevalence                0.1842                 0.0188
## Balanced Accuracy                   0.9875                 1.0000
##                      Class: Obesity_Type_III Class: Overweight_Level_I
## Sensitivity                         1.000000                    0.8704
## Specificity                         1.000000                    0.9575
## Pos Pred Value                      1.000000                    0.8393
## Neg Pred Value                      1.000000                    0.9667
## Prevalence                          0.007519                    0.2030
## Detection Rate                      0.007519                    0.1767
## Detection Prevalence                0.007519                    0.2105
## Balanced Accuracy                   1.000000                    0.9140
##                      Class: Overweight_Level_II
## Sensitivity                              0.9649
## Specificity                              0.9713
## Pos Pred Value                           0.9016
## Neg Pred Value                           0.9902
## Prevalence                               0.2143
## Detection Rate                           0.2068
## Detection Prevalence                     0.2293
## Balanced Accuracy                        0.9681
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pheatmap}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(conf\_matrix\_nn}\SpecialCharTok{$}\NormalTok{table), }\AttributeTok{cluster\_rows =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{cluster\_cols =} \ConstantTok{FALSE}\NormalTok{,}
        \AttributeTok{display\_numbers =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{color =} \FunctionTok{colorRampPalette}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"white"}\NormalTok{, }\StringTok{"red"}\NormalTok{))(}\DecValTok{100}\NormalTok{),}
        \AttributeTok{main =} \StringTok{"Confusion Matrix {-} Neural Network"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Predict_Obesity_level_files/figure-latex/unnamed-chunk-1-6.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(}\FunctionTok{levels}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Obesity\_Level)) }\SpecialCharTok{==} \DecValTok{2}\NormalTok{) \{}
\NormalTok{roc\_curve }\OtherTok{\textless{}{-}} \FunctionTok{roc}\NormalTok{(testData}\SpecialCharTok{$}\NormalTok{Obesity\_Level, }\FunctionTok{as.numeric}\NormalTok{(rf\_pred))}
\FunctionTok{plot}\NormalTok{(roc\_curve, }\AttributeTok{main =} \StringTok{"ROC Curve for Random Forest"}\NormalTok{)}
\FunctionTok{auc}\NormalTok{(roc\_curve)}
\NormalTok{\}}
         

\NormalTok{rf\_acc }\OtherTok{\textless{}{-}}\NormalTok{ conf\_matrix\_rf}\SpecialCharTok{$}\NormalTok{overall[}\StringTok{"Accuracy"}\NormalTok{]}
\NormalTok{nn\_acc }\OtherTok{\textless{}{-}}\NormalTok{ conf\_matrix\_nn}\SpecialCharTok{$}\NormalTok{overall[}\StringTok{"Accuracy"}\NormalTok{]}
         
\FunctionTok{cat}\NormalTok{(}\StringTok{"Random Forest Accuracy:"}\NormalTok{, rf\_acc, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Random Forest Accuracy: 0.9473684
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Neural Network Accuracy:"}\NormalTok{, nn\_acc, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Neural Network Accuracy: 0.9097744
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mcnemar\_test }\OtherTok{\textless{}{-}} \FunctionTok{mcnemar.test}\NormalTok{(}\FunctionTok{table}\NormalTok{(rf\_pred, nn\_pred\_factor))}
\FunctionTok{print}\NormalTok{(mcnemar\_test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  McNemar's Chi-squared test
## 
## data:  table(rf_pred, nn_pred_factor)
## McNemar's chi-squared = NaN, df = 21, p-value = NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{stopCluster}\NormalTok{(cl)}
\end{Highlighting}
\end{Shaded}


\end{document}
